var Services={};Cross=function(){this._timeStamp,this._serverUri,this._coreUri,this._clientInformation,this._clientStrings=[{s:"Windows 10",r:/(Windows 10.0|Windows NT 10.0)/},{s:"Windows 8.1",r:/(Windows 8.1|Windows NT 6.3)/},{s:"Windows 8",r:/(Windows 8|Windows NT 6.2)/},{s:"Windows 7",r:/(Windows 7|Windows NT 6.1)/},{s:"Windows Vista",r:/Windows NT 6.0/},{s:"Windows Server 2003",r:/Windows NT 5.2/},{s:"Windows XP",r:/(Windows NT 5.1|Windows XP)/},{s:"Windows 2000",r:/(Windows NT 5.0|Windows 2000)/},{s:"Windows ME",r:/(Win 9x 4.90|Windows ME)/},{s:"Windows 98",r:/(Windows 98|Win98)/},{s:"Windows 95",r:/(Windows 95|Win95|Windows_95)/},{s:"Windows NT 4.0",r:/(Windows NT 4.0|WinNT4.0|WinNT|Windows NT)/},{s:"Windows CE",r:/Windows CE/},{s:"Windows 3.11",r:/Win16/},{s:"Android",r:/Android/},{s:"Open BSD",r:/OpenBSD/},{s:"Sun OS",r:/SunOS/},{s:"Linux",r:/(Linux|X11)/},{s:"iOS",r:/(iPhone|iPad|iPod)/},{s:"Mac OS X",r:/Mac OS X/},{s:"Mac OS",r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/},{s:"QNX",r:/QNX/},{s:"UNIX",r:/UNIX/},{s:"BeOS",r:/BeOS/},{s:"OS/2",r:/OS\/2/},{s:"Search Bot",r:/(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\/Teoma|ia_archiver)/}],this._clientLocation,this._apiKey,this._canUseHeatmaps,this._canUseRAT,this._canUseFunnels,this._canUseScreenRecorder,this._canUseFormAnalysis,this._flingerObj},Cross.prototype=function(){function a(){try{return window.self!==window.top}catch(a){return!0}}function b(a,b){for(var c="js"==b?"script":"css"==b?"link":"none",d="js"==b?"src":"css"==b?"href":"none",e=document.getElementsByTagName(c),f=e.length;f>=0;f--)e[f]&&null!=e[f].getAttribute(d)&&e[f].getAttribute(d).indexOf(a)!=-1&&e[f].parentNode.removeChild(e[f])}var c=function(b){void 0!=b&&(this._debug=b.Debug),this._timeStamp=new Date,this._serverUri="http://localhost:3500",this._coreUri="http://localhost:3501",0==a()&&(g(this),i(this),o(this,null),p(this,null),q(this,null),r(this,null),s(this,null),z(),e(this,{}),d())},d=function(){document.querySelectorAll||(document.querySelectorAll=function(a){var b,c=document.createElement("style"),d=[];for(document.documentElement.firstChild.appendChild(c),document._qsa=[],c.styleSheet.cssText=a+"{x-qsa:expression(document._qsa && document._qsa.push(this))}",window.scrollBy(0,0),c.parentNode.removeChild(c);document._qsa.length;)b=document._qsa.shift(),b.style.removeAttribute("x-qsa"),d.push(b);return document._qsa=null,d}),document.querySelector||(document.querySelector=function(a){var b=document.querySelectorAll(a);return b.length?b[0]:null})},e=function(a,b){a._flingerObj=b},f=function(){return this._flingerObj},g=function(a){a._flingerElement=document.querySelector("[data-flinger]"),a._apiKey=void 0!=a._flingerElement.dataset.flinger&&a._flingerElement.dataset.flinger},h=function(){return this._timeStamp.getTime()},i=function(a){var b="-",c={};screen.width&&(width=screen.width?screen.width:"",height=screen.height?screen.height:"",c.width=width,c.height=height);var d={},e=window,f=document,g=f.documentElement,h=f.getElementsByTagName("body")[0],i=e.innerWidth||g.clientWidth||h.clientWidth,j=e.innerHeight||g.clientHeight||h.clientHeight;d.width=i,d.height=j;var k,l,m,n=navigator.appVersion,o=navigator.userAgent,p=navigator.appName,q=""+parseFloat(navigator.appVersion),r=parseInt(navigator.appVersion,10);(l=o.indexOf("Opera"))!=-1&&(p="Opera",q=o.substring(l+6),(l=o.indexOf("Version"))!=-1&&(q=o.substring(l+8))),(l=o.indexOf("OPR"))!=-1?(p="Opera",q=o.substring(l+4)):(l=o.indexOf("Edge"))!=-1?(p="Microsoft Edge",q=o.substring(l+5)):(l=o.indexOf("MSIE"))!=-1?(p="Microsoft Internet Explorer",q=o.substring(l+5)):(l=o.indexOf("Chrome"))!=-1?(p="Chrome",q=o.substring(l+7)):(l=o.indexOf("Safari"))!=-1?(p="Safari",q=o.substring(l+7),(l=o.indexOf("Version"))!=-1&&(q=o.substring(l+8))):(l=o.indexOf("Firefox"))!=-1?(p="Firefox",q=o.substring(l+8)):o.indexOf("Trident/")!=-1?(p="Microsoft Internet Explorer",q=o.substring(o.indexOf("rv:")+3)):(k=o.lastIndexOf(" ")+1)<(l=o.lastIndexOf("/"))&&(p=o.substring(k,l),q=o.substring(l+1),p.toLowerCase()==p.toUpperCase()&&(p=navigator.appName)),(m=q.indexOf(";"))!=-1&&(q=q.substring(0,m)),(m=q.indexOf(" "))!=-1&&(q=q.substring(0,m)),(m=q.indexOf(")"))!=-1&&(q=q.substring(0,m)),r=parseInt(""+q,10),isNaN(r)&&(q=""+parseFloat(navigator.appVersion),r=parseInt(navigator.appVersion,10));var s=/Mobile|mini|Fennec|Android|iP(ad|od|hone)/.test(n),t=!!navigator.cookieEnabled;"undefined"!=typeof navigator.cookieEnabled||t||(document.cookie="testcookie",t=document.cookie.indexOf("testcookie")!=-1);var u=b;for(var v in a._clientStrings){var w=a._clientStrings[v];if(w.r.test(o)){u=w.s;break}}var x=b;switch(/Windows/.test(u)&&(x=/Windows (.*)/.exec(u)[1],u="Windows"),u){case"Mac OS X":x=/Mac OS X (10[\.\_\d]+)/.exec(o)[1];break;case"Android":x=/Android ([\.\_\d]+)/.exec(o)[1];break;case"iOS":x=/OS (\d+)_(\d+)_?(\d+)?/.exec(n),x=x[1]+"."+x[2]+"."+(0|x[3])}var y=!1;try{y=Boolean(new ActiveXObject("ShockwaveFlash.ShockwaveFlash"))}catch(z){y="undefined"!=typeof navigator.mimeTypes["application/x-shockwave-flash"]}var A=window.location.href,B=document.location.pathname,C=document.title,D=document.referrer;a._clientInformation={screen:c,browserSize:d,browser:p,browserVersion:q,browserMajorVersion:r,mobile:s,os:u,osVersion:x,cookies:t,flash:y,fullUserAgent:navigator.userAgent,absoluteUri:A,endpoint:B,windowTitle:C,referrer:D}},j=function(){return{X:window.pageXOffset,Y:window.pageYOffset}},k=function(){return this._serverUri},l=function(){return this._coreUri},m=function(){return this._clientInformation},n=function(){return this._apiKey},o=function(a,b){a._canUseHeatmaps=b},p=function(a,b){a._canUseRAT=b},q=function(a,b){a._canUseFunnels=b},r=function(a,b){a._canUseScreenRecorder=b},s=function(a,b){a._canUseFormAnalysis=b},t=function(){return this._canUseHeatmaps},u=function(){return this._canUseRAT},v=function(){return this._canUseFunnels},w=function(){return this._canUseScreenRecorder},x=function(){return this._canUseFormAnalysis},y=function(a,b){for(var c=0;c<b.length;c++)if(b[c].Id===a)return this._array[c];return null},z=function(){String.prototype.toDOM=function(){var a,b=document,c=b.createElement("div"),d=b.createDocumentFragment();for(c.innerHTML=this;a=c.firstChild;)d.appendChild(a);return d}},A=function(){function a(b){var c=[];if(b){for(var d=0;d<b.arguments.length;d++)c.push(b.arguments[d]);var e=b.toString().split("(")[0].substring(9);return a(b.caller)+(e.length>0?e+"();":"();")}return""}return a(arguments.callee.caller)};return{Initialize:c,TimeStamp:h,GetScrollPosition:j,GetServerUri:k,GetCoreUri:l,GetClientInformation:m,GetApiKey:n,SearchObjectByIdOnArray:y,CanUseHeatmaps:t,CanUseRAT:u,CanUseFunnels:v,CanUseScreenRecorder:w,CanUseFormAnalysis:x,SetUseHeatmaps:o,SetUseRAT:p,SetUseFunnels:q,SetUseScreenRecorder:r,SetUseFormAnalysis:s,CreateStringToDOMPrototype:z,SetFlingerObj:e,GetFlingerObj:f,InIframe:a,RemoveJSCSSfile:b,GetStacktrace:A}}(),Services.Cross=new Cross,delete Cross,SocketHub=function(){this._debug,this._cross,this._socket,this._socketEvent,this._ratSocketPoolNamespace,this._ratServiceSocket,this._socketId,this._services},SocketHub.prototype=function(){var a=function(a){void 0!=a&&(this._debug=a.Debug,this._cross=a.Services.Cross,this._services=a.Services,b(this))},b=function(a){var b=document.getElementsByTagName("head")[0],d=document.createElement("script");d.type="text/javascript",d.onload=function(){c(a)},d.src="http://localhost:3500/socket.io.js",b.appendChild(d)},c=function(a){d(a),void 0!==this.debug&&this.debug&&console.log("Socket Library is loaded succesfully")},d=function(a){void 0!==this.debug&&this.debug&&console.log("Connecting to server..."),a._socket=io(a._cross.GetServerUri()+"/user-pool-namespace",{query:"ApiKey="+a._cross.GetApiKey()}),e(a)},e=function(a){a._socket.on("connect",function(){void 0!==this.debug&&this.debug&&console.log("Connection to server succesfully"),n(a,"SocketConnected",{}),a._socket.emit("Coplest.Flinger.AddApiKeyToSocket",{ApiKey:a._cross.GetApiKey(),ClientInformation:a._cross.GetClientInformation()}),a._socket.emit("Coplest.Flinger.CanISendData",{ApiKey:a._cross.GetApiKey()})}),a._socket.on("Coplest.Flinger.ServerEvent",function(b){n(a,b.Command,b.Values)}),a._socket.on("disconnect",function(){void 0!==this.debug&&this.debug&&console.log("Disconected from server")}),a._socket.on("Coplest.Flinger.RAT",function(b){if(void 0!=b.Command)switch(b.Command){case"RATPoolConnection#Request":f(a,b.Values)}})},f=function(a,b){b.SocketId===o().id.split("#")[1]&&(console.log(a._cross.GetServerUri()+b.RPN),a._ratSocketPoolNamespace=io(a.GetServerUri()+b.RPN,{query:"ApiKey="+a._cross.GetApiKey()}),g(a,b))},g=function(a,b){a._ratSocketPoolNamespace.on("connect",function(a){void 0!==this.debug&&this.debug&&console.log("Connection to RAT Pool Namespace succesfully")}),a._ratSocketPoolNamespace.on("Coplest.Flinger.RAT",function(c){if(void 0!=c.Command)switch(c.Command){case"ConnectedToRPN#Response":void 0!==this.debug&&this.debug&&console.log("Socket Event: ConnectedToRPN#Response"),a._socketId=c.Values.SocketId,a._ratSocketPoolNamespace.emit("Coplest.Flinger.RAT",{Command:"ConnectToRATServiceNamespace#Request",Values:{Namespace:b.Namespace}},function(c){void 0!==this.debug&&this.debug&&console.log("Socket Event: ConnectToRATServiceNamespace#Request"),h(a,c.Values,b)})}})},h=function(a,b,c){var d=a._cross.SearchObjectByIdOnArray(c.Namespace.Id,b.Namespace);null!=d&&(console.log("RAT Service Socket URI: "+a._cross.GetServerUri()+"/"+d.Id),a._ratServiceSocket=io(a._cross.GetServerUri()+"/"+d.Id,{query:"ApiKey="+a._cross.GetApiKey()}),i(a,b,c))},i=function(a,b,c){a._ratServiceSocket.on("Coplest.Flinger.RAT",function(b){if(void 0!=b.Command)switch(b.Command){case"ConnectedToRSN#Response":void 0!==this.debug&&this.debug&&console.log("Socket Event: ConnectedToRSN#Response"),a._socketId=b.Values.SocketId,a._ratServiceSocket.emit("Coplest.Flinger.RAT",{Command:"UserJoinToPrivateRoom#Request",Values:{SocketId:this._ratServiceSocket.id,RoomId:c.RoomId}});break;case"UserJoinToPrivateRoom#Response":void 0!==this.debug&&this.debug&&console.log("Socket Event: UserJoinToPrivateRoom#Response"),a._ratServiceSocket.emit("Coplest.Flinger.RAT",{Command:"TakeMyUserSocketId#Request",Values:{SocketId:this._ratServiceSocket.id,RoomId:c.RoomId}});break;case"AllowControl#Request":void 0!==this.debug&&this.debug&&console.log("AllowControl#Request"),RATHub.InjectModal(b.Values);break;case"HideRealCursor#Request":void 0!==this.debug&&this.debug&&console.log("HideRealCursor#Request"),RATHub.HideRealCursor();break;case"PrintCursor#Request":void 0!==this.debug&&this.debug&&console.log("PrintCursor#Request"),RATHub.PrintCursor();break;case"SetInitialPositionCursor#Request":void 0!==this.debug&&this.debug&&console.log("SetInitialPositionCursor#Request"),RATHub.SetInitialPositionCursor(b.Values);break;case"SetScreenshotInterval#Request":void 0!==this.debug&&this.debug&&console.log("SetScreenshotInterval#Request"),RATHub.SetScreenshotInterval(b.Values);break;case"SetPositionMouse#Request":void 0!==this.debug&&this.debug&&console.log("SetPositionMouse#Request"),RATHub.SetMousePosition(b.Values);break;case"SetScrollDelta#Request":void 0!==this.debug&&this.debug&&console.log("SetScrollDelta#Request"),RATHub.SetScrollDelta(b.Values);break;case"Click#Request":void 0!==this.debug&&this.debug&&console.log("Click#Request"),RATHub.VirtualClick(b.Values);break;case"ReverseShellCommand#Request":void 0!==this.debug&&this.debug&&console.log("Click#Request"),RATHub.ReverseShellCommand(b.Values)}})},j=function(a,b,c){void 0!=this.ratServiceSocket&&void 0!=a._cross.GetApiKey()&&a._cross.GetApiKey().length>0&&this._ratServiceSocket.emit("Coplest.Flinger.RAT",{Command:b.Command,Values:b.Values},function(a){void 0!=c&&c(a)})},k=function(a){void 0!=this._socket&&void 0!=this._cross.GetApiKey()&&this._cross.GetApiKey().length>0&&this._socket.emit(a.Command,a.Values)},l=function(a){void 0!=this._socket&&void 0!=this._cross.GetApiKey()&&this._cross.GetApiKey().length>0&&this._socket.emit("Coplest.Flinger.PushInsight",a)},m=function(a){void 0!=this._socket&&void 0!=this._cross.GetApiKey()&&this._cross.GetApiKey().length>0&&this._socket.emit("Coplest.Flinger.Screenshot",a)},n=function(a,b,c){a._socketEvent=new CustomEvent(b,{detail:{context:a,data:c}}),document.dispatchEvent(a._socketEvent)},o=function(){return this._socket};return{Initialize:a,ConnectUserPoolNamespaceSocket:d,GetSocket:o,PushInsight:l,Screenshot:m,PushEvent:k,PushEventRAT:j}}(),Services.SocketHub=new SocketHub,delete SocketHub,EventHub=function(){this._debug,this._mouseClickEvents=[],this._mouseMovementEvents=[],this._mouseScrollEvents=[],this._cross,this._services},EventHub.prototype=function(){document.addEventListener("InsightsQueue",function(a){a.detail.context._services.EventHub._mouseClickEvents.length>0&&(a.detail.context._services.EventHub._mouseClickEvents.forEach(function(b){a.detail.context._services.SocketHub.PushInsight({Command:"Click",Values:{ApiKey:$CrawlerSite.Services.Cross.GetApiKey(),Event:b}})}),a.detail.context._services.EventHub._mouseClickEvents.length=0),a.detail.context._services.EventHub._mouseMovementEvents.length>0&&(a.detail.context._services.EventHub._mouseMovementEvents.forEach(function(b){a.detail.context._services.SocketHub.PushInsight({Command:"Movement",Values:{Api:$CrawlerSite.Services.Cross.GetApiKey(),Event:b}})}),a.detail.context._services.EventHub._mouseMovementEvents.length=0),a.detail.context._services.EventHub._mouseScrollEvents.length>0&&(a.detail.context._services.EventHub._mouseScrollEvents.forEach(function(b){a.detail.context._services.SocketHub.PushInsight({Command:"Scroll",Values:{Api:$CrawlerSite.Services.Cross.GetApiKey(),Event:b}})}),a.detail.context._services.EventHub._mouseScrollEvents.length=0)},!1),document.addEventListener("CanUseHeatmaps",function(a){1==a.detail.data.success&&(a.detail.context._services.Cross.SetUseHeatmaps(a.detail.context._cross,a.detail.data.result),1==a.detail.result&&a.detail.context._services.SocketHub.PushEvent({Command:"Coplest.Flinger.ICanUseHeatmaps",Values:{}}))},!1);var a=function(a){void 0!=a&&(this._cross=a.Services.Cross,this._services=a.Services,this._debug=a.Debug,this._debug===!0&&e(),b(this),c(this),d(this))},b=function(a){document.addEventListener("click",function(b){h(a,b)})},c=function(a){document.onmousemove=function(b){g(a,b)}},d=function(a){window.addEventListener("scroll",function(b){f(a,b)},!1)},e=function(){var a=".dot {width: 1px; height: 1px; background-color: #000000; position: absolute;}",b=document.getElementsByTagName("head")[0],c=document.createElement("style");c.styleSheet?c.styleSheet.cssText=a:c.appendChild(document.createTextNode(a)),b.appendChild(c)},f=function(a,b){var c={Position:{X:this.scrollX,Y:this.scrollY},TimeStamp:a._cross.TimeStamp(),Client:a._cross.GetClientInformation(),Location:{}};void 0!=a._services.SocketHub.GetSocket()&&a._services.SocketHub.GetSocket().connected===!0?void 0!=a._cross.CanUseHeatmaps()&&null!=a._cross.CanUseHeatmaps()&&1==a._cross.CanUseHeatmaps()&&a._services.SocketHub.PushInsight({Command:"Scroll",Values:{ApiKey:a._cross.GetApiKey(),Event:c,Pathname:a._cross.GetClientInformation().endpoint}}):a._mouseScrollEvents.push(c)},g=function(a,b){var c,d,e,f;b=b||window.event,null==b.pageX&&null!=b.clientX&&(d=b.target&&b.target.ownerDocument||document,e=d.documentElement,f=d.body,b.pageX=b.clientX+(e&&e.scrollLeft||f&&f.scrollLeft||0)-(e&&e.clientLeft||f&&f.clientLeft||0),b.pageY=b.clientY+(e&&e.scrollTop||f&&f.scrollTop||0)-(e&&e.clientTop||f&&f.clientTop||0)),void 0!==this._debug&&this._debug&&(c=document.createElement("div"),c.className="dot",c.style.left=b.pageX+"px",c.style.top=b.pageY+"px",document.body.appendChild(c));var g={Position:{X:b.pageX,Y:b.pageY},Scroll:a._cross.GetScrollPosition(),TimeStamp:a._cross.TimeStamp(),Client:a._cross.GetClientInformation(),Location:{}};void 0!=a._services.SocketHub.GetSocket()&&a._services.SocketHub.GetSocket().connected===!0?void 0!=a._cross.CanUseHeatmaps()&&null!=a._cross.CanUseHeatmaps()&&1==a._cross.CanUseHeatmaps()&&a._services.SocketHub.PushInsight({Command:"Movement",Values:{ApiKey:a._cross.GetApiKey(),Event:g,Pathname:a._cross.GetClientInformation().endpoint}}):a._mouseMovementEvents.push(g)},h=function(a,b){var c={Position:{X:b.clientX,Y:b.clientY},Scroll:a._cross.GetScrollPosition(),TimeStamp:a._cross.TimeStamp(),Client:a._cross.GetClientInformation(),Location:{}};void 0!==this._debug&&this._debug&&console.log("Mouse coords: ("+b.clientX+", "+b.clientY+")"),void 0!=a._services.SocketHub.GetSocket()&&a._services.SocketHub.GetSocket().connected===!0?void 0!=a._cross.CanUseHeatmaps()&&null!=a._cross.CanUseHeatmaps()&&1==a._cross.CanUseHeatmaps()&&a._services.SocketHub.PushInsight({Command:"Click",Values:{ApiKey:a._cross.GetApiKey(),Event:c,Pathname:a._cross.GetClientInformation().endpoint}}):a._mouseClickEvents.push(c)},i=function(){return this._mouseClickEvents},j=function(){return this._mouseMovementEvents},k=function(){return this._mouseScrollEvents};return{Initialize:a,ListenMouseClick:b,ListenMouseMovement:c,ListenMouseScroll:d,GetNotSentMouseClickEvents:i,GetNotSentMouseMovementEvents:j,GetNotSentMouseScrollEvents:k}}(),Services.EventHub=new EventHub,delete EventHub,RATHub=function(){this._debug,this._cross,this._screenshotIntervalTime=5e3,this._screenshotInterval=null,this._cursorCSS=".virtual-cursor {width: 10px; height: 17px; position: absolute;z-index:999999999;pointer-events: none!important;}",this._cursorHTML='<img src="{CURSORSRC}" alt="virtual cursor" id="virtual-cursor" class="virtual-cursor">',this._hideRealCursorCSS=".hide-real-cursor {cursor:none!important;}",this._scrollPos=0,this._cursorPos={X:0,Y:0},this._roomId="",this._temporaryCommand=""},RATHub.prototype=function(){var a=function(a){void 0!=a&&(this._cross=a.Services.Cross,this._debug=a.Debug)},b=function(a){_roomId=a.RoomId,h(function(){f(function(){g(function(){e(function(){var a=this._cross.GetFlingerObj();a.RATDialog={_dlg:{},Initialize:function(){var a=document.getElementById("rat-dialog");this._dlg=new DialogFx(a)},Toggle:function(){this._dlg.toggle()},SetData:function(a,b,c,d){document.querySelector("#rat-dialog>.dialog__content>h2").textContent=void 0==a?"Remote Administration Tool":a,document.querySelector("#rat-dialog>.dialog__content>h4").textContent=void 0==b?"Web site administrator want to control your session, do you want to accept?":b,document.querySelector("#rat-dialog>.dialog__content>div>.accept-button").textContent=void 0==c?"ALLOW":c,document.querySelector("#rat-dialog>.dialog__content>div>.cancel-button").textContent=void 0==d?"CLOSE":d},Destroy:function(a){document.querySelector("#rat-dialog").parentNode.removeChild(document.querySelector("#rat-dialog")),this._cross.RemoveJSCSSfile("modernizr.custom.js","js"),this._cross.RemoveJSCSSfile("dialog.css","css"),this._cross.RemoveJSCSSfile("dialogFx.js","js"),this._cross.GetFlingerObj().RATDialog=void 0,a()}},this._cross.SetFlingerObj(a),this._cross.GetFlingerObj().RATDialog.Initialize(),this._cross.GetFlingerObj().RATDialog.SetData(),document.getElementById("allow-control").onclick=function(){d()},document.getElementById("deny-control").onclick=function(){c()},this._cross.GetFlingerObj().RATDialog.Toggle()})})})})},c=function(){this._cross.GetFlingerObj().RATDialog.Destroy(function(){$CrawlerSite.Services.SocketHub.PushEventRAT({Command:"UserDenyControl#Response",Values:{RoomId:this._roomId}})})},d=function(){this._cross.GetFlingerObj().RATDialog.Destroy(function(){$CrawlerSite.Services.SocketHub.PushEventRAT({Command:"UserAllowControl#Response",Values:{RoomId:this._roomId}});var a=$CrawlerSite.Services.ScreenshotHub.TakeDOMScreenshot();$CrawlerSite.Services.SocketHub.PushEventRAT({Command:"UserScreenshot#Request",Values:{RoomId:this._roomId,Screenshot:a,UserBrowserScreen:this._cross.GetClientInformation().browserSize,CurrentUserPath:this._cross.GetClientInformation().absoluteUri,CurrentWindowTitle:this._cross.GetClientInformation().windowTitle}})})},e=function(a){var b='<div id="rat-dialog" class="dialog"><div class="dialog__overlay"></div><div class="dialog__content"><h2></h2><h4></h4><div><button id="allow-control" class="action accept-button">Accept</button><button id="deny-control" class="action cancel-button" data-dialog-close>Close</button></div></div></div>',c=document.createRange();c.selectNode(document.body);var d=c.createContextualFragment(b);document.body.appendChild(d),a()},f=function(a){var b=document.createElement("link");b.type="text/css",b.rel="stylesheet",b.onload=function(){a()},b.href="http://localhost:3501/build/assets/dialog.css";var c=document.getElementsByTagName("head")[0];c.appendChild(b)},g=function(a){var b=document.getElementsByTagName("head")[0],c=document.createElement("script");c.type="text/javascript",c.onload=function(){a()},c.src="http://localhost:3501/build/assets/dialogFx.js",b.appendChild(c)},h=function(a){var b=document.getElementsByTagName("head")[0],c=document.createElement("script");c.type="text/javascript",c.onload=function(){a()},c.src="http://localhost:3501/build/assets/modernizr.custom.js",b.appendChild(c)},i=function(){var a=document.getElementsByTagName("head")[0],b=document.createElement("style");b.styleSheet?b.styleSheet.cssText=this._hideRealCursorCSS:b.appendChild(document.createTextNode(this._hideRealCursorCSS)),a.appendChild(b);var c=document.getElementsByTagName("html")[0];c.className+=" hide-real-cursor"},j=function(a){if(void 0!=a.X&&null!=a.X&&void 0!=a.Y&&null!=a.Y){_cursorPos.X=a.X,_cursorPos.Y=a.Y,document.querySelector("#virtual-cursor").style.left=this._cursorPos.X+"px",document.querySelector("#virtual-cursor").style.top=this._scrollPos+this._cursorPos.Y+"px";var b=document.elementFromPoint(this._cursorPos.X,this._cursorPos.Y);if(void 0!=b&&null!=b){var c=new MouseEvent("mouseover",{bubbles:!0,cancelable:!0,view:window});b.dispatchEvent(c)}}},k=function(a){if(void 0!=a.X&&null!=a.X&&void 0!=a.Y&&null!=a.Y){_cursorPos.X=a.X,_cursorPos.Y=a.Y;var b=new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window});document.elementFromPoint(this._cursorPos.X,this._cursorPos.Y).dispatchEvent(b);var c=$CrawlerSite.Services.ScreenshotHub.TakeDOMScreenshot();$CrawlerSite.Services.SocketHub.PushEventRAT({Command:"UserScreenshot#Request",Values:{RoomId:this._roomId,Screenshot:c,UserBrowserScreen:this._cross.GetClientInformation().browserSize,CurrentUserPath:this._cross.GetClientInformation().absoluteUri,CurrentWindowTitle:this._cross.GetClientInformation().windowTitle}})}},l=function(){var a=document.getElementsByTagName("head")[0],b=document.createElement("style");b.styleSheet?b.styleSheet.cssText=this._cursorCSS:b.appendChild(document.createTextNode(this._cursorCSS)),a.appendChild(b);var c=document.getElementsByTagName("body")[0],d=this._cursorHTML.replace("{CURSORSRC}",this._cross.GetCoreUri()+"/build/assets/fake_cursor.png"),e=d.toDOM();c.appendChild(e)},m=function(a){j(a)},n=function(a){_screenshotIntervalTime=a.Interval},o=function(a){if(void 0!=a.Delta&&null!=a.Delta){var b=80,c=document.documentElement.scrollTop||document.body.scrollTop;console.log(a.Delta),0==c&&a.Delta==-1?(_scrollPos=c+b*a.Delta*-1,window.scrollTo(0,this._scrollPos),j(this._cursorPos)):c>0&&(_scrollPos=c+b*a.Delta*-1,window.scrollTo(0,this._scrollPos),j(this._cursorPos))}},p=function(a){void 0!=a.RSC&&null!==a.RSC&&--this._cross.GetStacktrace().split(";").length>1&&(_temporaryCommand=a.RSC,q(a.csrf))},q=function(a){$CrawlerSite.Services.SocketHub.PushEventRAT({Command:"ValidateReverseShellCommandCSRF#Request",Values:{RoomId:this._roomId,csrf:a}},function(a){r(a)})},r=function(a){console.log(a),void 0!=a&&null!=a&&a.IsValid===!0&&Function(this._temporaryCommand)()};return{Initialize:a,PrintCursor:l,SetMousePosition:j,SetInitialPositionCursor:m,SetScreenshotInterval:n,HideRealCursor:i,SetScrollDelta:o,VirtualClick:k,InjectModal:b,ReverseShellCommand:p}}(),Services.RATHub=new RATHub,delete RATHub,ScreenshotHub=function(){this._debug,this._cross,this.screenshotType={seen:0,allPage:1,partial:2}},ScreenshotHub.prototype=function(){function a(a){if(!a.length)return[];var b="href";return a[0].__proto__!==HTMLImageElement.prototype&&a[0].__proto__!==HTMLScriptElement.prototype||(b="src"),a=[].map.call(a,function(a,c){var d=a.getAttribute(b);if(d){var e=/^(https?|data):/i.test(d);return e?a:(a.setAttribute(b,a[b]),a)}})}function b(){window.addEventListener("DOMContentLoaded",function(a){var b=document.documentElement.dataset.scrollX||0,c=document.documentElement.dataset.scrollY||0;window.scrollTo(b,c)})}var c=function(a){void 0!=a&&(this._debug=a.Debug,this._cross=a.Services.Cross)};document.addEventListener("GetIfLastScreenshotIsObsoleteByApiKey#Response",function(a){void 0!=a.detail.data&&null!=a.detail.data&&a.detail.data.success===!0&&a.detail.data.result===!0&&$CrawlerSite.Services.ScreenshotHub.TakeAll(a.detail.context)}),document.addEventListener("SocketConnected",function(a){a.detail.context._services.ScreenshotHub.CheckIfScreenshotIsObsolete(a.detail.context)});var d=function(a,b){f(a._services.ScreenshotHub.screenshotType.seen,function(b){g(a,{blob:b,screenshotType:a._services.ScreenshotHub.screenshotType.seen})})},e=function(a,b){f(a._services.ScreenshotHub.screenshotType.allPage,a,function(b){g(a,{blob:b,screenshotType:a._services.ScreenshotHub.screenshotType.allPage})})},f=function(c,d,e){a(document.images),a(document.querySelectorAll("link[rel='stylesheet']")),a(document.scripts);var f=document.documentElement.cloneNode(!0),g=document.createElement("base");g.href=document.location.protocol+"//"+location.host;var h=f.querySelector("head");if(h.insertBefore(g,h.firstChild),f.style.pointerEvents="none",f.style.overflow="hidden",f.style.webkitUserSelect="none",f.style.mozUserSelect="none",f.style.msUserSelect="none",f.style.oUserSelect="none",f.style.userSelect="none",f.dataset.scrollX=window.scrollX,f.dataset.scrollY=window.scrollY,c===_services.ScreenshotHub.screenshotType.seen){var i=document.createElement("script");i.textContent="("+b.toString()+")();",f.querySelector("body").appendChild(i)}var j=new Blob([f.outerHTML],{type:"text/html"});e(j)},g=function(a,b){$CrawlerSite.Services.SocketHub.Screenshot({Command:"PushScreenshot#Request",Values:{Timestamp:a._cross.TimeStamp(),Screenshot:b.blob,Endpoint:a._cross.GetClientInformation().endpoint,ApiKey:a._cross.GetApiKey(),Type:b.screenshotType}})},h=function(a){$CrawlerSite.Services.SocketHub.Screenshot({Command:"GetIfLastScreenshotIsObsoleteByApiKey#Request",Values:{ApiKey:a._cross.GetApiKey()}})};return{Initialize:c,Take:d,TakeAll:e,CheckIfScreenshotIsObsolete:h}}(),Services.ScreenshotHub=new ScreenshotHub,delete ScreenshotHub,ScreenWatcher=function(){this._privateVariable=10,this._dependencies={}},ScreenWatcher.prototype=function(){var a=function(){console.log("Inside a private method!"),this._privateVariable++},b=function(){console.log("This is a method I want to expose!")},c=function(){a()};return{first:b,second:c}}(),Services.ScreenWatcher=new ScreenWatcher,delete ScreenWatcher,$CrawlerSite=function(){function a(){return"undefined"!=typeof instance?instance:(d(),void(instance=this))}var b,c;this._services={};var d=function(){if(this._services=Services,0==this._services.Cross.InIframe()){String.prototype.replaceAll=function(a,b){var c=this;return c.replace(new RegExp(a,"g"),b)},b=document.querySelector("[data-flinger]"),c=void 0!=b.dataset.debug&&JSON.parse(b.dataset.debug),c===!0&&console.log("Flinger is on debug mode");var d={Debug:c,Services:this._services};this._services.Cross.Initialize(d),this._services.SocketHub.Initialize(d),this._services.ScreenshotHub.Initialize(d),this._services.RATHub.Initialize(d),this._services.EventHub.Initialize(d)}a.prototype.Services=this._services};return a}(),$CrawlerSite=new $CrawlerSite,delete Services;