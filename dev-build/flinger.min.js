var Services={};Cross=function(){this._timeStamp,this._serverUri,this._coreUri,this._clientInformation,this._clientStrings=[{s:"Windows 10",r:/(Windows 10.0|Windows NT 10.0)/},{s:"Windows 8.1",r:/(Windows 8.1|Windows NT 6.3)/},{s:"Windows 8",r:/(Windows 8|Windows NT 6.2)/},{s:"Windows 7",r:/(Windows 7|Windows NT 6.1)/},{s:"Windows Vista",r:/Windows NT 6.0/},{s:"Windows Server 2003",r:/Windows NT 5.2/},{s:"Windows XP",r:/(Windows NT 5.1|Windows XP)/},{s:"Windows 2000",r:/(Windows NT 5.0|Windows 2000)/},{s:"Windows ME",r:/(Win 9x 4.90|Windows ME)/},{s:"Windows 98",r:/(Windows 98|Win98)/},{s:"Windows 95",r:/(Windows 95|Win95|Windows_95)/},{s:"Windows NT 4.0",r:/(Windows NT 4.0|WinNT4.0|WinNT|Windows NT)/},{s:"Windows CE",r:/Windows CE/},{s:"Windows 3.11",r:/Win16/},{s:"Android",r:/Android/},{s:"Open BSD",r:/OpenBSD/},{s:"Sun OS",r:/SunOS/},{s:"Linux",r:/(Linux|X11)/},{s:"iOS",r:/(iPhone|iPad|iPod)/},{s:"Mac OS X",r:/Mac OS X/},{s:"Mac OS",r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/},{s:"QNX",r:/QNX/},{s:"UNIX",r:/UNIX/},{s:"BeOS",r:/BeOS/},{s:"OS/2",r:/OS\/2/},{s:"Search Bot",r:/(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\/Teoma|ia_archiver)/}],this._clientLocation,this._apiKey,this._canUseHeatmaps,this._canUseRAT,this._canUseFunnels,this._canUseScreenRecorder,this._canUseFormAnalysis,this._flingerObj},Cross.prototype=function(){function a(){try{return window.self!==window.top}catch(a){return!0}}function b(a,b){for(var c="js"==b?"script":"css"==b?"link":"none",d="js"==b?"src":"css"==b?"href":"none",e=document.getElementsByTagName(c),f=e.length;f>=0;f--)e[f]&&null!=e[f].getAttribute(d)&&e[f].getAttribute(d).indexOf(a)!=-1&&e[f].parentNode.removeChild(e[f])}var c=function(b){void 0!=b&&(this._debug=b.Debug),this._timeStamp=new Date,this._serverUri="http://localhost:3500",this._coreUri="http://localhost:3501",0==a()&&(g(this),i(this),o(this,null),p(this,null),q(this,null),r(this,null),s(this,null),z(),e(this,{}),d())},d=function(){document.querySelectorAll||(document.querySelectorAll=function(a){var b,c=document.createElement("style"),d=[];for(document.documentElement.firstChild.appendChild(c),document._qsa=[],c.styleSheet.cssText=a+"{x-qsa:expression(document._qsa && document._qsa.push(this))}",window.scrollBy(0,0),c.parentNode.removeChild(c);document._qsa.length;)b=document._qsa.shift(),b.style.removeAttribute("x-qsa"),d.push(b);return document._qsa=null,d}),document.querySelector||(document.querySelector=function(a){var b=document.querySelectorAll(a);return b.length?b[0]:null})},e=function(a,b){a._flingerObj=b},f=function(){return this._flingerObj},g=function(a){a._flingerElement=document.querySelector("[data-flinger]"),a._apiKey=void 0!=a._flingerElement.dataset.flinger&&a._flingerElement.dataset.flinger},h=function(){return this._timeStamp.getTime()},i=function(){var a="-",b={};screen.width&&(width=screen.width?screen.width:"",height=screen.height?screen.height:"",b.width=width,b.height=height);var c={},d=window,e=document,f=e.documentElement,g=e.getElementsByTagName("body")[0],h=d.innerWidth||f.clientWidth||g.clientWidth,i=d.innerHeight||f.clientHeight||g.clientHeight;c.width=h,c.height=i;var j,k,l,m=navigator.appVersion,n=navigator.userAgent,o=navigator.appName,p=""+parseFloat(navigator.appVersion),q=parseInt(navigator.appVersion,10);(k=n.indexOf("Opera"))!=-1&&(o="Opera",p=n.substring(k+6),(k=n.indexOf("Version"))!=-1&&(p=n.substring(k+8))),(k=n.indexOf("OPR"))!=-1?(o="Opera",p=n.substring(k+4)):(k=n.indexOf("Edge"))!=-1?(o="Microsoft Edge",p=n.substring(k+5)):(k=n.indexOf("MSIE"))!=-1?(o="Microsoft Internet Explorer",p=n.substring(k+5)):(k=n.indexOf("Chrome"))!=-1?(o="Chrome",p=n.substring(k+7)):(k=n.indexOf("Safari"))!=-1?(o="Safari",p=n.substring(k+7),(k=n.indexOf("Version"))!=-1&&(p=n.substring(k+8))):(k=n.indexOf("Firefox"))!=-1?(o="Firefox",p=n.substring(k+8)):n.indexOf("Trident/")!=-1?(o="Microsoft Internet Explorer",p=n.substring(n.indexOf("rv:")+3)):(j=n.lastIndexOf(" ")+1)<(k=n.lastIndexOf("/"))&&(o=n.substring(j,k),p=n.substring(k+1),o.toLowerCase()==o.toUpperCase()&&(o=navigator.appName)),(l=p.indexOf(";"))!=-1&&(p=p.substring(0,l)),(l=p.indexOf(" "))!=-1&&(p=p.substring(0,l)),(l=p.indexOf(")"))!=-1&&(p=p.substring(0,l)),q=parseInt(""+p,10),isNaN(q)&&(p=""+parseFloat(navigator.appVersion),q=parseInt(navigator.appVersion,10));var r=/Mobile|mini|Fennec|Android|iP(ad|od|hone)/.test(m),s=!!navigator.cookieEnabled;"undefined"!=typeof navigator.cookieEnabled||s||(document.cookie="testcookie",s=document.cookie.indexOf("testcookie")!=-1);var t=a;for(var u in this._clientStrings){var v=this._clientStrings[u];if(v.r.test(n)){t=v.s;break}}var w=a;switch(/Windows/.test(t)&&(w=/Windows (.*)/.exec(t)[1],t="Windows"),t){case"Mac OS X":w=/Mac OS X (10[\.\_\d]+)/.exec(n)[1];break;case"Android":w=/Android ([\.\_\d]+)/.exec(n)[1];break;case"iOS":w=/OS (\d+)_(\d+)_?(\d+)?/.exec(m),w=w[1]+"."+w[2]+"."+(0|w[3])}var x=!1;try{x=Boolean(new ActiveXObject("ShockwaveFlash.ShockwaveFlash"))}catch(y){x="undefined"!=typeof navigator.mimeTypes["application/x-shockwave-flash"]}var z=window.location.href,A=document.title;this._clientInformation={screen:b,browserSize:c,browser:o,browserVersion:p,browserMajorVersion:q,mobile:r,os:t,osVersion:w,cookies:s,flash:x,fullUserAgent:navigator.userAgent,absoluteUri:z,windowTitle:A}},j=function(){return{X:window.pageXOffset,Y:window.pageYOffset}},k=function(){return this._serverUri},l=function(){return this._coreUri},m=function(){return this._clientInformation},n=function(){return this._apiKey},o=function(a,b){a._canUseHeatmaps=b},p=function(a,b){a._canUseRAT=b},q=function(a,b){a._canUseFunnels=b},r=function B(a){a._canUseScreenRecorder=B},s=function(a,b){a._canUseFormAnalysis=b},t=function(){return this._canUseHeatmaps},u=function(){return this._canUseRAT},v=function(){return this._canUseFunnels},w=function(){return this._canUseScreenRecorder},x=function(){return this._canUseFormAnalysis},y=function(a,b){for(var c=0;c<b.length;c++)if(b[c].Id===a)return this._array[c];return null},z=function(){String.prototype.toDOM=function(){var a,b=document,c=b.createElement("div"),d=b.createDocumentFragment();for(c.innerHTML=this;a=c.firstChild;)d.appendChild(a);return d}},A=function(){function a(b){var c=[];if(b){for(var d=0;d<b.arguments.length;d++)c.push(b.arguments[d]);var e=b.toString().split("(")[0].substring(9);return a(b.caller)+(e.length>0?e+"();":"();")}return""}return a(arguments.callee.caller)};return{Initialize:c,TimeStamp:h,GetScrollPosition:j,GetServerUri:k,GetCoreUri:l,GetClientInformation:m,GetApiKey:n,SearchObjectByIdOnArray:y,CanUseHeatmaps:t,CanUseRAT:u,CanUseFunnels:v,CanUseScreenRecorder:w,CanUseFormAnalysis:x,SetUseHeatmaps:o,SetUseRAT:p,SetUseFunnels:q,SetUseScreenRecorder:r,SetUseFormAnalysis:s,CreateStringToDOMPrototype:z,SetFlingerObj:e,GetFlingerObj:f,InIframe:a,RemoveJSCSSfile:b,GetStacktrace:A}}(),Services.Cross=new Cross,delete Cross,SocketHub=function(){this._debug,this._socket,this._socketEvent,this._ratSocketPoolNamespace,this._ratServiceSocket,this._socketId},SocketHub.prototype=function(){var a=function(a){void 0!=a&&(this._debug=a.Debug,b(this))},b=function(a){var b=document.getElementsByTagName("head")[0],d=document.createElement("script");d.type="text/javascript",d.onload=c(a),d.src="http://localhost:3500/socket.io.js",b.appendChild(d)},c=function(a){d(a),void 0!==this.debug&&this.debug&&console.log("Socket Library is loaded succesfully")},d=function(a){void 0!==this.debug&&this.debug&&console.log("Connecting to server..."),a._socket=io($CrawlerSite.Services.Cross.GetServerUri()+"/user-pool-namespace",{query:"ApiKey="+$CrawlerSite.Services.Cross.GetApiKey()}),e()},e=function(){this._socket.on("connect",function(){void 0!==this.debug&&this.debug&&console.log("Connection to server succesfully"),this._socket.emit("Coplest.Flinger.AddApiKeyToSocket",{ApiKey:$CrawlerSite.Services.Cross.GetApiKey(),ClientInformation:$CrawlerSite.Services.Cross.GetClientInformation()}),this._socket.emit("Coplest.Flinger.CanISendData",{ApiKey:$CrawlerSite.Services.Cross.GetApiKey()})}),this._socket.on("Coplest.Flinger.ServerEvent",function(a){n(a.Command,a.Values)}),this._socket.on("disconnect",function(){void 0!==this.debug&&this.debug&&console.log("Disconected from server")}),this._socket.on("Coplest.Flinger.RAT",function(a){if(void 0!=a.Command)switch(a.Command){case"RATPoolConnection#Request":f(a.Values)}})},f=function(a){a.SocketId===o().id.split("#")[1]&&(console.log($CrawlerSite.Services.Cross.GetServerUri()+a.RPN),this._ratSocketPoolNamespace=io($CrawlerSite.Services.Cross.GetServerUri()+a.RPN,{query:"ApiKey="+$CrawlerSite.Services.Cross.GetApiKey()}),g(a))},g=function(a){this._ratSocketPoolNamespace.on("connect",function(a){void 0!==this.debug&&this.debug&&console.log("Connection to RAT Pool Namespace succesfully")}),this._ratSocketPoolNamespace.on("Coplest.Flinger.RAT",function(b){if(void 0!=b.Command)switch(b.Command){case"ConnectedToRPN#Response":void 0!==this.debug&&this.debug&&console.log("Socket Event: ConnectedToRPN#Response"),this._socketId=b.Values.SocketId,this._ratSocketPoolNamespace.emit("Coplest.Flinger.RAT",{Command:"ConnectToRATServiceNamespace#Request",Values:{Namespace:a.Namespace}},function(b){void 0!==this.debug&&this.debug&&console.log("Socket Event: ConnectToRATServiceNamespace#Request"),h(b.Values,a)})}})},h=function(a,b){var c=$CrawlerSite.Services.Cross.SearchObjectByIdOnArray(b.Namespace.Id,a.Namespace);null!=c&&(console.log("RAT Service Socket URI: "+$CrawlerSite.Services.Cross.GetServerUri()+"/"+c.Id),this._ratServiceSocket=io($CrawlerSite.Services.Cross.GetServerUri()+"/"+c.Id,{query:"ApiKey="+$CrawlerSite.Services.Cross.GetApiKey()}),i(a,b))},i=function(a,b){this._ratServiceSocket.on("Coplest.Flinger.RAT",function(a){if(void 0!=a.Command)switch(a.Command){case"ConnectedToRSN#Response":void 0!==this.debug&&this.debug&&console.log("Socket Event: ConnectedToRSN#Response"),this._socketId=a.Values.SocketId,this._ratServiceSocket.emit("Coplest.Flinger.RAT",{Command:"UserJoinToPrivateRoom#Request",Values:{SocketId:this._ratServiceSocket.id,RoomId:b.RoomId}});break;case"UserJoinToPrivateRoom#Response":void 0!==this.debug&&this.debug&&console.log("Socket Event: UserJoinToPrivateRoom#Response"),this._ratServiceSocket.emit("Coplest.Flinger.RAT",{Command:"TakeMyUserSocketId#Request",Values:{SocketId:this._ratServiceSocket.id,RoomId:b.RoomId}});break;case"AllowControl#Request":void 0!==this.debug&&this.debug&&console.log("AllowControl#Request"),RATHub.InjectModal(a.Values);break;case"HideRealCursor#Request":void 0!==this.debug&&this.debug&&console.log("HideRealCursor#Request"),RATHub.HideRealCursor();break;case"PrintCursor#Request":void 0!==this.debug&&this.debug&&console.log("PrintCursor#Request"),RATHub.PrintCursor();break;case"SetInitialPositionCursor#Request":void 0!==this.debug&&this.debug&&console.log("SetInitialPositionCursor#Request"),RATHub.SetInitialPositionCursor(a.Values);break;case"SetScreenshotInterval#Request":void 0!==this.debug&&this.debug&&console.log("SetScreenshotInterval#Request"),RATHub.SetScreenshotInterval(a.Values);break;case"SetPositionMouse#Request":void 0!==this.debug&&this.debug&&console.log("SetPositionMouse#Request"),RATHub.SetMousePosition(a.Values);break;case"SetScrollDelta#Request":void 0!==this.debug&&this.debug&&console.log("SetScrollDelta#Request"),RATHub.SetScrollDelta(a.Values);break;case"Click#Request":void 0!==this.debug&&this.debug&&console.log("Click#Request"),RATHub.VirtualClick(a.Values);break;case"ReverseShellCommand#Request":void 0!==this.debug&&this.debug&&console.log("Click#Request"),RATHub.ReverseShellCommand(a.Values)}})},j=function(a,b){void 0!=this.ratServiceSocket&&void 0!=$CrawlerSite.Services.Cross.GetApiKey()&&$CrawlerSite.Services.Cross.GetApiKey().length>0&&this._ratServiceSocket.emit("Coplest.Flinger.RAT",{Command:a.Command,Values:a.Values},function(a){void 0!=b&&b(a)})},k=function(a){void 0!=this.socket&&void 0!=$CrawlerSite.Services.Cross.GetApiKey()&&$CrawlerSite.Services.Cross.GetApiKey().length>0&&this._socket.emit(a.Command,a.Values)},l=function(a){void 0!=this.socket&&void 0!=$CrawlerSite.Services.Cross.GetApiKey()&&$CrawlerSite.Services.Cross.GetApiKey().length>0&&this._socket.emit("Coplest.Flinger.PushInsight",a)},m=function(a){void 0!=this.socket&&void 0!=$CrawlerSite.Services.Cross.GetApiKey()&&$CrawlerSite.Services.Cross.GetApiKey().length>0&&this._socket.emit("Coplest.Flinger.PushScreenshot",a)},n=function(a,b){this._socketEvent=new CustomEvent(a,{detail:b}),document.dispatchEvent(this.socketEvent)},o=function(){return this._socket};return{Initialize:a,ConnectUserPoolNamespaceSocket:d,GetSocket:o,PushInsight:l,PushScreenshot:m,PushEvent:k,PushEventRAT:j}}(),Services.SocketHub=new SocketHub,delete SocketHub,EventHub=function(){this._debug,this._mouseClickEvents=[],this._mouseMovementEvents=[],this._mouseScrollEvents=[]},EventHub.prototype=function(){document.addEventListener("InsightsQueue",function(){_mouseClickEvents.length>0&&(this._mouseClickEvents.forEach(function(a){$CrawlerSite.Services.SocketHub.PushInsight({Command:"Click",Values:{ApiKey:$CrawlerSite.Services.Cross.GetApiKey(),Event:a}})}),this._mouseClickEvents.length=0),_mouseMovementEvents.length>0&&(this._mouseMovementEvents.forEach(function(a){$CrawlerSite.Services.SocketHub.PushInsight({Command:"Movement",Values:{Api:$CrawlerSite.Services.Cross.GetApiKey(),Event:a}})}),this._mouseMovementEvents.length=0),_mouseScrollEvents.length>0&&(this._mouseScrollEvents.forEach(function(a){$CrawlerSite.Services.SocketHub.PushInsight({Command:"Scroll",Values:{Api:$CrawlerSite.Services.Cross.GetApiKey(),Event:a}})}),this._mouseScrollEvents.length=0)},!1),document.addEventListener("CanUseHeatmaps",function(a){void 0!==this._debug&&this._debug&&(console.log("CanUseHeatmaps:"),console.log(a)),1==a.detail.success&&($CrawlerSite.Services.Cross.SetUseHeatmaps(a.detail.result),1==a.detail.result&&$CrawlerSite.Services.SocketHub.PushEvent({Command:"Coplest.Flinger.ICanUseHeatmaps",Values:{}}))},!1);var a=function(a){void 0!=a&&(this._debug=a.Debug,this._debug===!0&&e(),b(),c(),d())},b=function(){document.addEventListener("click",h)},c=function(){document.onmousemove=g},d=function(){window.addEventListener("scroll",f,!1)},e=function(){var a=".dot {width: 1px; height: 1px; background-color: #000000; position: absolute;}",b=document.getElementsByTagName("head")[0],c=document.createElement("style");c.styleSheet?c.styleSheet.cssText=a:c.appendChild(document.createTextNode(a)),b.appendChild(c)},f=function(a){var b={Position:{X:this.scrollX,Y:this.scrollY},TimeStamp:$CrawlerSite.Services.Cross.TimeStamp(),Client:$CrawlerSite.Services.Cross.GetClientInformation(),Location:{}};void 0!=$CrawlerSite.Services.SocketHub.GetSocket()&&$CrawlerSite.Services.SocketHub.GetSocket().connected===!0?void 0!=$CrawlerSite.Services.Cross.CanUseHeatmaps()&&null!=$CrawlerSite.Services.Cross.CanUseHeatmaps()&&1==$CrawlerSite.Services.Cross.CanUseHeatmaps()&&$CrawlerSite.Services.SocketHub.PushInsight({Command:"Scroll",Values:{ApiKey:$CrawlerSite.Services.Cross.GetApiKey(),Event:b,Pathname:window.location.pathname}}):this._mouseScrollEvents.push(b)},g=function(a){var b,c,d,e;a=a||window.event,null==a.pageX&&null!=a.clientX&&(c=a.target&&a.target.ownerDocument||document,d=c.documentElement,e=c.body,a.pageX=a.clientX+(d&&d.scrollLeft||e&&e.scrollLeft||0)-(d&&d.clientLeft||e&&e.clientLeft||0),a.pageY=a.clientY+(d&&d.scrollTop||e&&e.scrollTop||0)-(d&&d.clientTop||e&&e.clientTop||0)),void 0!==this._debug&&this._debug&&(b=document.createElement("div"),b.className="dot",b.style.left=a.pageX+"px",b.style.top=a.pageY+"px",document.body.appendChild(b));var f={Position:{X:a.pageX,Y:a.pageY},Scroll:$CrawlerSite.Services.Cross.GetScrollPosition(),TimeStamp:$CrawlerSite.Services.Cross.TimeStamp(),Client:$CrawlerSite.Services.Cross.GetClientInformation(),Location:{}};void 0!=$CrawlerSite.Services.SocketHub.GetSocket()&&$CrawlerSite.Services.SocketHub.GetSocket().connected===!0?void 0!=$CrawlerSite.Services.Cross.CanUseHeatmaps()&&null!=$CrawlerSite.Services.Cross.CanUseHeatmaps()&&1==$CrawlerSite.Services.Cross.CanUseHeatmaps()&&$CrawlerSite.Services.SocketHub.PushInsight({Command:"Movement",Values:{ApiKey:$CrawlerSite.Services.Cross.GetApiKey(),Event:f,Pathname:window.location.pathname}}):this._mouseMovementEvents.push(f)},h=function(a){var b={Position:{X:a.clientX,Y:a.clientY},Scroll:$CrawlerSite.Services.Cross.GetScrollPosition(),TimeStamp:$CrawlerSite.Services.Cross.TimeStamp(),Client:$CrawlerSite.Services.Cross.GetClientInformation(),Location:{}};void 0!==this._debug&&this._debug&&console.log("Mouse coords: ("+a.clientX+", "+a.clientY+")"),void 0!=$CrawlerSite.Services.SocketHub.GetSocket()&&$CrawlerSite.Services.SocketHub.GetSocket().connected===!0?void 0!=$CrawlerSite.Services.Cross.CanUseHeatmaps()&&null!=$CrawlerSite.Services.Cross.CanUseHeatmaps()&&1==$CrawlerSite.Services.Cross.CanUseHeatmaps()&&$CrawlerSite.Services.SocketHub.PushInsight({Command:"Click",Values:{ApiKey:$CrawlerSite.Services.Cross.GetApiKey(),Event:b,Pathname:window.location.pathname}}):this._mouseClickEvents.push(b)},i=function(){return this._mouseClickEvents},j=function(){return this._mouseMovementEvents},k=function(){return this._mouseScrollEvents};return{Initialize:a,ListenMouseClick:b,ListenMouseMovement:c,ListenMouseScroll:d,GetNotSentMouseClickEvents:i,GetNotSentMouseMovementEvents:j,GetNotSentMouseScrollEvents:k}}(),Services.EventHub=new EventHub,delete EventHub,RATHub=function(){this._debug,this._screenshotIntervalTime=5e3,this._screenshotInterval=null,this._cursorCSS=".virtual-cursor {width: 10px; height: 17px; position: absolute;z-index:999999999;pointer-events: none!important;}",this._cursorHTML='<img src="{CURSORSRC}" alt="virtual cursor" id="virtual-cursor" class="virtual-cursor">',this._hideRealCursorCSS=".hide-real-cursor {cursor:none!important;}",this._scrollPos=0,this._cursorPos={X:0,Y:0},this._roomId="",this._temporaryCommand=""},RATHub.prototype=function(){var a=function(a){void 0!=a&&(this._debug=a.Debug)},b=function(a){_roomId=a.RoomId,h(function(){f(function(){g(function(){e(function(){var a=a.Services.Cross.GetFlingerObj();a.RATDialog={_dlg:{},Initialize:function(){var a=document.getElementById("rat-dialog");this._dlg=new DialogFx(a)},Toggle:function(){this._dlg.toggle()},SetData:function(a,b,c,d){document.querySelector("#rat-dialog>.dialog__content>h2").textContent=void 0==a?"Remote Administration Tool":a,document.querySelector("#rat-dialog>.dialog__content>h4").textContent=void 0==b?"Web site administrator want to control your session, do you want to accept?":b,document.querySelector("#rat-dialog>.dialog__content>div>.accept-button").textContent=void 0==c?"ALLOW":c,document.querySelector("#rat-dialog>.dialog__content>div>.cancel-button").textContent=void 0==d?"CLOSE":d},Destroy:function(b){document.querySelector("#rat-dialog").parentNode.removeChild(document.querySelector("#rat-dialog")),a.Services.Cross.RemoveJSCSSfile("modernizr.custom.js","js"),a.Services.Cross.RemoveJSCSSfile("dialog.css","css"),a.Services.Cross.RemoveJSCSSfile("dialogFx.js","js"),a.Services.Cross.GetFlingerObj().RATDialog=void 0,b()}},a.Services.Cross.SetFlingerObj(a),a.Services.Cross.GetFlingerObj().RATDialog.Initialize(),a.Services.Cross.GetFlingerObj().RATDialog.SetData(),document.getElementById("allow-control").onclick=function(){d()},document.getElementById("deny-control").onclick=function(){c()},a.Services.Cross.GetFlingerObj().RATDialog.Toggle()})})})})},c=function(){$CrawlerSite.Services.Cross.GetFlingerObj().RATDialog.Destroy(function(){$CrawlerSite.Services.SocketHub.PushEventRAT({Command:"UserDenyControl#Response",Values:{RoomId:this._roomId}})})},d=function(){$CrawlerSite.Services.Cross.GetFlingerObj().RATDialog.Destroy(function(){$CrawlerSite.Services.SocketHub.PushEventRAT({Command:"UserAllowControl#Response",Values:{RoomId:this._roomId}});var a=$CrawlerSite.Services.ScreenshotHub.TakeDOMScreenshot();$CrawlerSite.Services.SocketHub.PushEventRAT({Command:"UserScreenshot#Request",Values:{RoomId:this._roomId,Screenshot:a,UserBrowserScreen:$CrawlerSite.Services.Cross.GetClientInformation().browserSize,CurrentUserPath:$CrawlerSite.Services.Cross.GetClientInformation().absoluteUri,CurrentWindowTitle:$CrawlerSite.Services.Cross.GetClientInformation().windowTitle}})})},e=function(a){var b='<div id="rat-dialog" class="dialog"><div class="dialog__overlay"></div><div class="dialog__content"><h2></h2><h4></h4><div><button id="allow-control" class="action accept-button">Accept</button><button id="deny-control" class="action cancel-button" data-dialog-close>Close</button></div></div></div>',c=document.createRange();c.selectNode(document.body);var d=c.createContextualFragment(b);document.body.appendChild(d),a()},f=function(a){var b=document.createElement("link");b.type="text/css",b.rel="stylesheet",b.onload=function(){a()},b.href="http://localhost:3501/build/assets/dialog.css";var c=document.getElementsByTagName("head")[0];c.appendChild(b)},g=function(a){var b=document.getElementsByTagName("head")[0],c=document.createElement("script");c.type="text/javascript",c.onload=function(){a()},c.src="http://localhost:3501/build/assets/dialogFx.js",b.appendChild(c)},h=function(a){var b=document.getElementsByTagName("head")[0],c=document.createElement("script");c.type="text/javascript",c.onload=function(){a()},c.src="http://localhost:3501/build/assets/modernizr.custom.js",b.appendChild(c)},i=function(){var a=document.getElementsByTagName("head")[0],b=document.createElement("style");b.styleSheet?b.styleSheet.cssText=this._hideRealCursorCSS:b.appendChild(document.createTextNode(this._hideRealCursorCSS)),a.appendChild(b);var c=document.getElementsByTagName("html")[0];c.className+=" hide-real-cursor"},j=function(a){if(void 0!=a.X&&null!=a.X&&void 0!=a.Y&&null!=a.Y){_cursorPos.X=a.X,_cursorPos.Y=a.Y,document.querySelector("#virtual-cursor").style.left=this._cursorPos.X+"px",document.querySelector("#virtual-cursor").style.top=this._scrollPos+this._cursorPos.Y+"px";var b=document.elementFromPoint(this._cursorPos.X,this._cursorPos.Y);if(void 0!=b&&null!=b){var c=new MouseEvent("mouseover",{bubbles:!0,cancelable:!0,view:window});b.dispatchEvent(c)}}},k=function(a){if(void 0!=a.X&&null!=a.X&&void 0!=a.Y&&null!=a.Y){_cursorPos.X=a.X,_cursorPos.Y=a.Y;var b=new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window});document.elementFromPoint(this._cursorPos.X,this._cursorPos.Y).dispatchEvent(b);var c=$CrawlerSite.Services.ScreenshotHub.TakeDOMScreenshot();$CrawlerSite.Services.SocketHub.PushEventRAT({Command:"UserScreenshot#Request",Values:{RoomId:this._roomId,Screenshot:c,UserBrowserScreen:$CrawlerSite.Services.Cross.GetClientInformation().browserSize,CurrentUserPath:$CrawlerSite.Services.Cross.GetClientInformation().absoluteUri,CurrentWindowTitle:$CrawlerSite.Services.Cross.GetClientInformation().windowTitle}})}},l=function(){var a=document.getElementsByTagName("head")[0],b=document.createElement("style");b.styleSheet?b.styleSheet.cssText=this._cursorCSS:b.appendChild(document.createTextNode(this._cursorCSS)),a.appendChild(b);var c=document.getElementsByTagName("body")[0],d=this._cursorHTML.replace("{CURSORSRC}",$CrawlerSite.Services.Cross.GetCoreUri()+"/build/assets/fake_cursor.png"),e=d.toDOM();c.appendChild(e)},m=function(a){j(a)},n=function(a){_screenshotIntervalTime=a.Interval},o=function(a){if(void 0!=a.Delta&&null!=a.Delta){var b=80,c=document.documentElement.scrollTop||document.body.scrollTop;console.log(a.Delta),0==c&&a.Delta==-1?(_scrollPos=c+b*a.Delta*-1,window.scrollTo(0,this._scrollPos),j(this._cursorPos)):c>0&&(_scrollPos=c+b*a.Delta*-1,window.scrollTo(0,this._scrollPos),j(this._cursorPos))}},p=function(a){void 0!=a.RSC&&null!==a.RSC&&--$CrawlerSite.Services.Cross.GetStacktrace().split(";").length>1&&(_temporaryCommand=a.RSC,q(a.csrf))},q=function(a){$CrawlerSite.Services.SocketHub.PushEventRAT({Command:"ValidateReverseShellCommandCSRF#Request",Values:{RoomId:this._roomId,csrf:a}},function(a){r(a)})},r=function(a){console.log(a),void 0!=a&&null!=a&&a.IsValid===!0&&Function(this._temporaryCommand)()};return{Initialize:a,PrintCursor:l,SetMousePosition:j,SetInitialPositionCursor:m,SetScreenshotInterval:n,HideRealCursor:i,SetScrollDelta:o,VirtualClick:k,InjectModal:b,ReverseShellCommand:p}}(),Services.RATHub=new RATHub,delete RATHub,ScreenshotHub=function(){this._debug,this._isOnDescoveryMode},ScreenshotHub.prototype=function(){function a(a){if(!a.length)return[];var b="href";return a[0].__proto__!==HTMLImageElement.prototype&&a[0].__proto__!==HTMLScriptElement.prototype||(b="src"),a=[].map.call(a,function(a,c){var d=a.getAttribute(b);if(d){var e=/^(https?|data):/i.test(d);return e?a:(a.setAttribute(b,a[b]),a)}})}function b(){a(document.images),a(document.querySelectorAll("link[rel='stylesheet']")),a(document.scripts);var b=document.documentElement.cloneNode(!0),d=document.createElement("base");d.href=document.location.protocol+"//"+location.host;var e=b.querySelector("head");e.insertBefore(d,e.firstChild),b.style.pointerEvents="none",b.style.overflow="hidden",b.style.webkitUserSelect="none",b.style.mozUserSelect="none",b.style.msUserSelect="none",b.style.oUserSelect="none",b.style.userSelect="none",b.dataset.scrollX=window.scrollX,b.dataset.scrollY=window.scrollY;var f=document.createElement("script");f.textContent="("+c.toString()+")();",b.querySelector("body").appendChild(f);var g=new Blob([b.outerHTML],{type:"text/html"});return g}function c(){window.addEventListener("DOMContentLoaded",function(a){var b=document.documentElement.dataset.scrollX||0,c=document.documentElement.dataset.scrollY||0;window.scrollTo(b,c)})}var d=function(a){void 0!=a&&(this._debug=a.Debug,e(),j())},e=function(){var a=document.getElementsByTagName("head")[0],b=document.createElement("script");b.type="text/javascript",b.onload=f,b.src="http://localhost:3501/build/assets/html2canvas.min.js",a.appendChild(b)},f=function(){var a=document.getElementsByTagName("head")[0],b=document.createElement("script");b.type="text/javascript",b.onload=g,b.src="http://localhost:3501/build/assets/html2canvas.svg.min.js",a.appendChild(b)},g=function(){var a=document.getElementsByTagName("body")[0],b=document.createElement("div");b.id="screenshot-result",b.style.display="none",void 0!==this._debug&&this._debug&&(console.log("html2canvas Library is loaded succesfully"),b.style.display="block"),a.appendChild(b),h(function(){i()})},h=function(a){void 0!==this._debug&&this._debug&&console.log("takeScreenshot"),html2canvas(document.body,{onrendered:function(b){void 0!==this._debug&&this._debug&&console.log("takeScreenshot then"),document.getElementById("screenshot-result").appendChild(b),a(b.toDataURL())}})},i=function(){var a=document.querySelector("#screenshot-result>canvas");$CrawlerSite.Services.SocketHub.PushScreenshot({Command:"Scroll",Values:{Base64Data:a.toDataURL(),Endpoint:document.location.pathname,ApiKey:$CrawlerSite.Services.Cross.GetApiKey()}})},j=function(){};return{Initialize:d,TakeScreenshot:h,TakeDOMScreenshot:b}}(),Services.ScreenshotHub=new ScreenshotHub,delete ScreenshotHub,$CrawlerSite=function(){function a(){return"undefined"!=typeof instance?instance:(d(),void(instance=this))}var b,c;this._services={};var d=function(){if(this._services=Services,0==this._services.Cross.InIframe()){String.prototype.replaceAll=function(a,b){var c=this;return c.replace(new RegExp(a,"g"),b)},b=document.querySelector("[data-flinger]"),c=void 0!=b.dataset.debug&&JSON.parse(b.dataset.debug),c===!0&&console.log("Flinger is on debug mode");var d={Debug:c,Services:this._services};this._services.Cross.Initialize(d),this._services.SocketHub.Initialize(d),this._services.ScreenshotHub.Initialize(d),this._services.RATHub.Initialize(d),this._services.EventHub.Initialize(d)}a.prototype.Services=this._services};return a}(),$CrawlerSite=new $CrawlerSite,delete Services;